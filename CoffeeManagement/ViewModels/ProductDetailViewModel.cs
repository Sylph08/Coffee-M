using CoffeeManagement.Models;
using MaterialDesignThemes.Wpf;
using Microsoft.Win32;
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.IO;
using System.Linq;
using System.Reflection;
using System.Text;
using System.Text.RegularExpressions;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;

namespace CoffeeManagement.ViewModels
{
    public class ProductDetailViewModel : BaseViewModel
    {
        public ICommand DeleteImageCommand { get; set; }
        public ICommand LoadMealTypeFromProductTypeCommand { get; set; }
        public ICommand LoadProductTypeCommand { get; set; }
        public ICommand SaveCommand { get; set; }
        public ICommand EditCommand { get; set; }
        public ICommand LoadCommand { get; set; }
        public ICommand LoadImageCommand { get; set; }
        private string _DisplayName;
        public string DisplayName { get => _DisplayName; set { _DisplayName = value; OnPropertyChanged(); } }
        private MealType _SelectedMealType;
        public MealType SelectedMealType { get => _SelectedMealType; set { _SelectedMealType = value; OnPropertyChanged(); } }
        private ProductType _SelectedProductType;
        public ProductType SelectedProductType { get => _SelectedProductType; set { _SelectedProductType = value; OnPropertyChanged(); } }
        private string _BuyValue;
        public string BuyValue { get => _BuyValue; set { _BuyValue = value; OnPropertyChanged(); } }
        private string _SellValue;
        public string SellValue { get => _SellValue; set { _SellValue = value; OnPropertyChanged(); } }
        private string _MinimumQuantity;
        public string MinimumQuantity { get => _MinimumQuantity; set { _MinimumQuantity = value; OnPropertyChanged(); } }
        private string _CurrentQuantity;
        public string CurrentQuantity { get => _CurrentQuantity; set { _CurrentQuantity = value; OnPropertyChanged(); } }
        private Unit _SelectedUnit;
        public Unit SelectedUnit { get => _SelectedUnit; set { _SelectedUnit = value; OnPropertyChanged(); } }
        private State _SelectedState;
        public State SelectedState { get => _SelectedState; set { _SelectedState = value; OnPropertyChanged(); } }
        private string _Note;
        public string Note { get => _Note; set { _Note = value; OnPropertyChanged(); } }
        private BitmapImage _SelectedImage;
        public BitmapImage SelectedImage { get => _SelectedImage; set { _SelectedImage = value; OnPropertyChanged(); } }

        private ObservableCollection<State> _StateList;
        public ObservableCollection<State> StateList { get => _StateList; set { _StateList = value; OnPropertyChanged(); } }
        private ObservableCollection<MealType> _MealTypeList;
        public ObservableCollection<MealType> MealTypeList { get => _MealTypeList; set { _MealTypeList = value; OnPropertyChanged(); } }
        private ObservableCollection<ProductType> _ProductTypeList;
        public ObservableCollection<ProductType> ProductTypeList { get => _ProductTypeList; set { _ProductTypeList = value; OnPropertyChanged(); } }
        private ObservableCollection<Unit> _UnitList;
        public ObservableCollection<Unit> UnitList { get => _UnitList; set { _UnitList = value; OnPropertyChanged(); } }

        public Product initProduct = new Product();
        public string DefaultImageUri = string.Format("pack://application:,,,/{0};component/{1}", Assembly.GetExecutingAssembly().GetName().Name, "Resources/no_image.png");
        //public string ImageUri1 = Path.Combine(Environment.CurrentDirectory, @"Resources\no_image.png");
        Uri ImageUri2 = new Uri("pack://application:,,,/Resources/no_image.png");

        //private bool Started_State;//if true: addcommand call this window; if false: editcommand call this window
        private List<Product> _sourceProduct;
        public List<Product> sourceProduct { get => _sourceProduct; set => _sourceProduct = value; }
        private bool IsClickedToImg;// cho biet da thuc hien thay doi anh chua
        public ProductDetailViewModel()
        {
            DeleteImageCommand= new RelayCommand<Image>((p) =>
            {
                return true;
            }, (p) =>
            {
                try
                {
                    //SelectedImage = LocalDictionary.Base64ToImage("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");
                    SelectedImage = new BitmapImage(new Uri(DefaultImageUri));
                    IsClickedToImg = true;
                    (p as Image).Source = SelectedImage;
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.ToString());
                }
            });
            LoadImageCommand = new RelayCommand<Image>((p) =>
            {
                return true;
            }, (p) =>
            {
                try
                {
                    BitmapImage backupSI = new BitmapImage();
                    backupSI = SelectedImage;
                    OpenFileDialog Op = new OpenFileDialog();
                    Op.Title = "Chọn hình ảnh sản phẩm";
                    Op.Filter = "JPG(.jpg)|*.jpg|PNG(.png)|*.png|JPEG(.jpeg)|*.jpeg";
                    if (Op.ShowDialog() == true)
                    {
                        IsClickedToImg = true;
                        SelectedImage = new BitmapImage(new Uri(Op.FileName.ToString()));
                    }
                    else
                    {
                        IsClickedToImg = false;
                        if (SelectedImage != backupSI) SelectedImage = backupSI;
                    }
                    p.Source = SelectedImage;
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.ToString());
                }
            });

            LoadCommand = new RelayCommand<Window>((p) =>
             {
                 return true;
             }, (p) =>
             {
                 try
                 {
                     InitData();
                     if (initProduct != null)
                     {

                         p.Title = initProduct.DisplayName;
                         (p.FindName("GridRow0") as Grid).IsEnabled = false;
                         //(p.FindName("SaveButton") as Button).IsEnabled = false;
                         (p.FindName("PictureCard") as Card).IsEnabled = false;
                         (p.FindName("EditButton") as Button).IsEnabled = true;
                         (p.FindName("LoadImgBtn") as Button).IsEnabled = false;
                         (p.FindName("DeleteImgBtn") as Button).IsEnabled = false;
                         //set value
                         DisplayName = initProduct.DisplayName;
                         SelectedProductType = initProduct.ProductType;
                         SelectedMealType = MealTypeList.Where(x => x.Id == SelectedProductType.MealTypeID).FirstOrDefault();
                         BuyValue = initProduct.BuyValue.ToString();
                         SellValue = initProduct.SellValue.ToString();
                         MinimumQuantity = initProduct.MinimumQuantity.ToString();
                         CurrentQuantity = initProduct.CurrentQuantity.ToString();
                         SelectedUnit = initProduct.Unit;
                         SelectedState = initProduct.IsTrading == true ? StateList[0] : StateList[1];
                         Note = initProduct.Note;
                         SelectedImage = LocalDictionary.Base64ToImage(initProduct.ProductImage);
                     }
                     else
                     {
                         DisplayName = null;
                         SelectedProductType = null;
                         SelectedMealType = null;
                         BuyValue = null;
                         SellValue = null;
                         MinimumQuantity = null;
                         CurrentQuantity = null;
                         SelectedUnit = null;
                         SelectedState = null;
                         Note = null;
                         SelectedImage = new BitmapImage(ImageUri2);
                         //SelectedImage = LocalDictionary.Base64ToImage("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");
                         (p.FindName("EditButton") as Button).IsEnabled = false;
                         (p.FindName("LoadImgBtn") as Button).IsEnabled = true;
                         (p.FindName("DeleteImgBtn") as Button).IsEnabled = true;
                     }
                 }
                 catch (Exception ex)
                 {
                     MessageBox.Show(ex.ToString());
                 }
             });

            LoadProductTypeCommand = new RelayCommand<Window>((p) =>
            {
                return true;
            }, (p) =>
            {
                try
                {
                    if (SelectedMealType != null)
                    {
                        int id = SelectedMealType.Id;
                        ProductTypeList = new ObservableCollection<ProductType>(DataProvider.Ins.DB.ProductTypes.Where(x => x.MealTypeID == id));
                    }
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.ToString());
                }
            });

            LoadMealTypeFromProductTypeCommand = new RelayCommand<Window>((p) =>
            {
                return true;
            }, (p) =>
            {
                try
                {
                    ///////////extension
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.ToString());
                }
            });


            EditCommand = new RelayCommand<Window>((p) =>
            {
                if (initProduct == null) return false;
                return true;
            }, (p) =>
            {
                try
                {
                    (p.FindName("GridRow0") as Grid).IsEnabled = true;
                    //(p.FindName("SaveButton") as Button).IsEnabled = true;
                    (p.FindName("PictureCard") as Card).IsEnabled = true;
                    (p.FindName("LoadImgBtn") as Button).IsEnabled = true; 
                    (p.FindName("DeleteImgBtn") as Button).IsEnabled = true;
                    (p.FindName("EditButton") as Button).IsEnabled = false;
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.ToString());
                }
            });

            SaveCommand = new RelayCommand<Window>((p) =>
            {
                if (String.IsNullOrEmpty(DisplayName) || String.IsNullOrEmpty(SellValue) || SelectedProductType == null || SelectedState == null) return false;
                if (initProduct != null)
                {
                    Product pr = sourceProduct.Where(x => x.Id == initProduct.Id).FirstOrDefault();
                    if (pr.DisplayName != DisplayName || (pr.ProductTypeID == null ? 0 : pr.ProductTypeID) != (SelectedProductType == null ? 0 : SelectedProductType.Id)) return true;
                    if (pr.BuyValue.ToString() != BuyValue) return true;
                    if (pr.SellValue.ToString() != SellValue) return true;
                    if (pr.MinimumQuantity.ToString() != MinimumQuantity) return true;
                    if (pr.CurrentQuantity.ToString() != CurrentQuantity) return true;
                    if ((pr.UnitID == null ? 0 : pr.UnitID) != (SelectedUnit == null ? 0 : SelectedUnit.Id)) return true;
                    if (IsClickedToImg) return true;
                    if (pr.Note != Note) return true;
                    if (pr.IsTrading != SelectedState.Id) return true;
                    //if (pr.ProductImage != BitmapImageToBase64(SelectedImage)) return true;
                    //if (LocalDictionary.Base64ToImage(pr.ProductImage) != SelectedImage) return true;
                    //int c = sourceProduct.Where(x => x.DisplayName == DisplayName && x.ProductTypeID.ToString() == SelectedProductType.Id.ToString()
                    //&& x.BuyValue.ToString() == BuyValue && x.SellValue.ToString() == SellValue
                    //&& x.MinimumQuantity.ToString() == MinimumQuantity && x.CurrentQuantity.ToString() == CurrentQuantity
                    //&& x.UnitID.ToString() == SelectedUnit.Id.ToString() && x.IsTrading == SelectedState.Id && x.Note == Note
                    //&& x.ProductImage == BitmapImageToBase64(SelectedImage)).Count();
                    //if (c > 0) return false;
                    return false;
                }
                else
                {
                    int c = sourceProduct.Where(x => x.DisplayName == DisplayName).Count();
                    if (c > 0) return false;
                }
                return true;
            }, (p) =>
            {
                try
                {
                    if (initProduct != null) //edit
                    {
                        var product = sourceProduct.Where(x => x.Id == initProduct.Id).FirstOrDefault();
                        product.DisplayName = DisplayName;
                        product.ProductTypeID = SelectedProductType.Id;
                        product.BuyValue = String.IsNullOrEmpty(BuyValue) ? (int?)null : Convert.ToInt32(BuyValue); // tip hay
                        product.SellValue = String.IsNullOrEmpty(SellValue) ? (int?)null : Convert.ToInt32(SellValue);
                        product.MinimumQuantity = String.IsNullOrEmpty(MinimumQuantity) ? (int?)null : Convert.ToInt32(MinimumQuantity);
                        product.CurrentQuantity = String.IsNullOrEmpty(CurrentQuantity) ? (int?)null : Convert.ToInt32(CurrentQuantity);
                        if (SelectedUnit != null) product.UnitID = SelectedUnit.Id;
                        product.Note = Note;
                        product.IsTrading = SelectedState.Id;
                        product.ProductImage = BitmapImageToBase64(SelectedImage).ToString();
                        string proImg = product.ProductImage;
                        CompareWithDeadPicture(ref proImg);
                        product.ProductImage = proImg;
                        //if (product.ProductImage == "/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCAHEAcQDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD8qqKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/2Q==")
                        //    product.ProductImage = "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";

                        if (DataProvider.Ins.DB.SaveChanges() > 0) MessageBox.Show("Cập nhật thành công!");
                        else MessageBox.Show("Cập nhật thất bại!");
                    }
                    else // add new
                    {
                        Product newProduct = new Product();
                        newProduct.Id = Guid.NewGuid().ToString();
                        //newProduct.Id = "SanPham" + sourceProduct.Count.ToString();
                        newProduct.DisplayName = DisplayName;
                        newProduct.ProductTypeID = SelectedProductType.Id;
                        newProduct.BuyValue = String.IsNullOrEmpty(BuyValue) ? (int?)null : Convert.ToInt32(BuyValue);
                        newProduct.SellValue = Convert.ToInt32(SellValue);
                        newProduct.MinimumQuantity = String.IsNullOrEmpty(MinimumQuantity) ? (int?)null : Convert.ToInt32(MinimumQuantity);
                        newProduct.CurrentQuantity = String.IsNullOrEmpty(CurrentQuantity) ? (int?)null : Convert.ToInt32(CurrentQuantity);
                        if (SelectedUnit != null) newProduct.UnitID = SelectedUnit.Id;
                        newProduct.Note = Note;
                        newProduct.IsTrading = SelectedState.Id;
                        newProduct.ProductImage = BitmapImageToBase64(SelectedImage).ToString();
                        string proImg = newProduct.ProductImage;
                        CompareWithDeadPicture(ref proImg);
                        newProduct.ProductImage = proImg;
                        //if (newProduct.ProductImage == "/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCAHEAcQDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD8qqKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/2Q==")
                        //    newProduct.ProductImage = "iVBORw0KGgoAAAANSUhEUgAAAcQAAAHECAYAAACnX1ofAAAABmJLR0QA/wD/AP+gvaeTAAAZ00lEQVR4nO3df+y1d33X8dddet9MClIYiFA0jGzFCtnGNGhkbgnEQR25B7jhpkT/0Rn3xxiRYDT+MTTqXMymyaLEH1mXuQ0opQacjXMYM43CNqcT3WRdQ0aEwlospUB7t9DbP845Kb257+v7Oedcnx/XdR6P5P1P25zrus73x7Of63vO+SQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMJpzSb4jyU8luSfJw0m+mOS3k/xkkj+9/W8AYLVuTvKfk1w+Y/5Lkpd1OkcAqOrbkzyYs2O4m88lubXLmQJAJTdnvxju5lKSix3OFwCqKLlNKooArNqfyuExFEUAVuO2HB9EUQRg8e7OPEG8nOTRJK9ve/oAMI9LmS+IVooALNbcQRRFABbpnswfRFEEYHH+VeoE0d8UAViU16VeEK0UAViMc0l+NaIIAPnGJJ+PKAJAvjN1XnEqigAszq1JHkndKHqhDQCLIIoAsCWKALAligCwJYoAsCWKALAligCwJYoAsCWKALDVIoqXIooALIAoAsCWKALAligCwJYoAsCWKALAligCwJYoAsCWKALAligCwJYoAsCWKALAligCwJYoAsCWKALAligCwJYoAsCWKALAligCwJYoAnCUczM+1nuTPPMq//zuJG9J8tiMx7qai0luT3Kh4jEeTfJLFR8fgP08mOS753igOYN4X5LnXOPfvS/J96Z+FG9NcmeSp1Y+DgBjuD/Jc+d4oOvmeJACb0zyriTnKx/nriRvyOb2JgAUaxXERBQBGFjLICaiCMCgWgcxEUUABtQjiIkoAjCYXkFMRBGAgfQMYiKKAAyidxATUQRgACMEMRFFADobJYiJKALQ0UhBTEQRgE5GC2IiigB0MGIQE1EEoLFRg5iIIgANjRzERBQBaGT0ICaiCEAD1/c+gat4a5JPXOWfvyDJ71Q+9l1J3pTk9iQXKh/rp5N8oPIxAEZ1U5If730StdyX5PIMc0vrE7+KW5M8knmu51rzaJLXt7oggMHcknl+l9431wkt4ZZpDy1un55P8p6IIsAQBPHaRBHghAjiNFEEOBGCeDZRBDgBglhGFAFWThDLiSLAignifkQRYKUEcX+iCLBCgngYUQRYGUE8nCgCrIggHkcUAVZCEI8nigArIIjzEEWAhRPE+YgiwIIJ4rxEEWChBHF+ogiwQIJYhygCLIwg1iOKAAsiiHWJIsBCCGJ9ogiwAILYhigCDE4Q2xFFgIEJYluiCDAoQWxPFAEGJIh9iCLAYASxH1EEGIgg9iWKAIMQxP5EEWAAgjgGUQToTBDHIYoAHQniWEQRoBNBHI8oAnQgiGMSRYDGBHFcogjQkCCOTRQBGhHE8YkiQAOCuAyiCFCZIC6HKAJUJIjLIooAlQji8ogiQAWCuEyiCDAzQVwuUQSYkSAumygCzEQQl08UAWYgiOsgigBHEsT1EEWAIwjiuogiwIEEcX1EEeAAgrhOogiwJ0FcL1EE2IMgrpsoAhQSxPUTRYAC1/c+AZq4K8mbktye5EKlY5xP8u4k35Pk/ZWOAft6XpKbkzwryQ1JnpHks0m+kOR3k/xWkge7nR2rdV+SyzPMLa1P/IRczGalOMfX6VpzaXscaO1ckj+e5G8l+WCSB1L2PXtvkjuT/GCSlzQ/69N1S+b5nXNf6xMvIYjLIIqszYuS/O0kH8s837+/muQtSW5seREnSBALRhDrE0XW4CVJbkvyaOp8Dz+Y5O8leW6rCzoxglgwgtjGrUkeSd0oPhovtGF+T0vyw6n/P3W7eSCbFeNTWlzcCRHEghHEdqwUWZo/meTjaRPCK+dDSb6u/iWeDEEsGEFsSxRZgnNJ/kaSx9Inhrt5IO56zEUQC0YQ23P7lJE9Jck/S98QfuU8nuRtVa/4NAhiwQhiH1aKjOh8kn+d/hG82ryj4nWfAkEsGEHsx0qRkZzL5lWkvcM3NX+t2tWvnyAWjCD2ZaXIKH40/YN31jyezaczsT9BLBhB7M9Kkd6+M5vY9A5eyTyU5A/VeRpWTRALRhDHYKVILzcl+Uz6h26f+bVs/t5JOUEsGEEch5UiPdye/oE7ZLzydD+CWDCCOBYrRVp6TfqH7dB5KMkL539KVksQC0YQx2OlSCu/nP5hO2Z+Yv6nZLUEsWAEcUyiSG3fkf5BO3YeTvKCuZ+YlRouiNfN9UCs3m6T4UcrHmO3ybDbp6fph3qfwAy+Jslf6X0S9GeFeBqsFKnheen/OaVzzcey+VABplkhsnhWitTw55Jc3/skZvKiJH+i90mwP0HkEO/PZgV3qeIxLiR5b6wUT8Vre5/AzF7T+wTYnyByqLuSvCF1o3g+yXsiimt3Ickre5/EzF7V+wTYnyByDLdPmcM3Jbmh90nM7BXxyTWLI4gcy+1TjrXGzwE9n+TFvU+C/Qgic7BS5Bg39z6BSl7S+wTYjyAyFytFDvX83idQyVqva7UEkTl5oQ2HeHrvE6jkGb1PgP0IInNz+5R9CSJDEERqcPuUfdT8n6eean7/U4EgUovbp5R6qPcJVPK53ifAfgSRmtw+pcRne59AJWu9rtUSRGpz+5Sz/HbvE6jk7t4nwH4EkRbcPmXKR3ufQCWCuDCCSCtun3Itv57NNj5r8vEk/6/3SbAfQaQlt0+5mk8n+c3eJzGzD/Y+AfYniLRmpcjVrC0g/6H3CdDXfZln9+NbWp84Xdya5JHU3bn8UqwUl+Lb0n+n+7nm4SQ3zvv0rNItmef5vq/1iZcQRPYliuycS3JP+sdsjnn3zM/NWg0XRLdM6anF7dMLcft0CS4n+Ze9T2Im/7z3CdCfFSKHslIkSX5vkgfSf4V3zHx49mdlvawQ4SqsFEk2H3X2E71P4kh/p/cJMAYrRI5lpcjTknws/Vd6h8y/q/B8rNlwK8Q5CSJzuJhNtGpH0UpxXG9M/7jtOw8n+foaT8aKCWLBCCJWityW/pHbZ36gztOwaoJYMII4tmdk88b32qwUT9sNSf53+oeuZN5T6TlYO0EsGEEc17OT/Nckd6RNFK0UT9uLk9yb/sGbml9O8vRaT8DKCWLBCOKYXpjkN/LE1+m9sVKkvpcneTD9w3e1+WiS59a79NUTxIIRxPF8XTZ71l35tbJSpIU/ks0HgPcO4FfOR5LcVPOiT4AgFowgjuWbknwq1/56WSnSwtdnsyLrHcLLSX4hmw8R4DiCWDCCOI5XJLk/Z3/NrBRp4RlJfib9Qvh4kh9J8pTaF3oiBLFgBHEMr0ny+ZR/3awUaeXNmb5rUWM+kuRbW1zcCRHEghHE/r4nh0VHFGnlxiQ/nuSLqft98Okkb02b7+tTI4gFI4h9/aUkX8rhXz9RpKXnJfkHKbu1v8/ck+SHsvkoOeoQxIIRxH7els3fSY79GooirV1I8l1JfjaHvyL17iT/JMkrs9mfkbqGC+KcX/T7kjxnhsf5w0l+c4bHYT9/N8nfnPHx7kjyfUkem/Exr+Ziktuz+YVYy6PZ3EZ+f8VjMJ9zSV6azds1XpLkG7K5xfqsJNdn8z85n8smnB/dzoeSfLzHyZ6wW7J5b/Ox7s+A7we1Qlymc9n8LabG6sqrT4FrGW6FOCdBXJ6nJPnJ1A2JKAJXI4gFI4ht/J4kH0jdgOzmbY2uyd8UYTkEsWAEsb6nJ/n3aRPDn0vbl6xbKcIyCGLBCGJdz87mBQQtYvhPk1zX5rKeRBRhfIJYMIJYz/OT/M+0ieGPNLqmaxFFGJsgFowg1nGtHSvmnseTvL3RNZ1FFGFcglgwgji/lyb5ROrH8EtJ/nKjayolijAmQSwYQZxX6Y4Vc0ThTY2uaV+iCOMRxIIRxPm8KptP5Kgdwy8keW2jazqUKMJYBLFgBHEe35Xk4dSP4QNZzrY4ogjjEMSCEcTj/YVsPkO0dgw/neSbG13TXEQRxiCIBSOIx/nBzLNjxVnzO0lubnRNcxNF6E8QC0YQD/fXUz+El7PZjeQPNLqmWkQR+hLEghHE/dXcseLK+W8ZcKuVA4ki9COIBSOI+2mxY8VufinJM9tcVjOiCH0IYsEIYrmnJnlf2sTw32SzQ8YaiSK0J4gFI4hl1rxjRQ+iCG0JYsEI4tlOYceKHkQR2hHEghHEaa13rDjX5rKGIYrQhiAWjCBe2ynuWNGDKEJ9glgwgnh1p7xjRQ+iCHUJYsEI4lezY0Ufogj1CGLBCOKTvSrJQ6kfwy9kEwCeTBShDkEsGEF8gh0rxiCKMD9BLBhB3LBjxVhEEeYliAUjiHasGJUownwEsWBOPYitdqz4P1n+jhU9iCLMQxAL5lSD2HrHit/X5rJWSRTheIJYMKcYxOuT3JY2MVzjjhU9iCIcRxAL5tSC2HLHip/Penes6EEU4XCCWDCnFEQ7ViyfKMJhBLFgTiWIdqxYD1GE/QliwZxCEJ+f5CNpE8NT3LGiB1GE/Qhiwaw9iHasWC9RhHKCWDBrDmLLHSu+v9E18WSiCGUEsWDWGsRXZvOZobVjeCnJn210TVzdxWy+DrW/zhdbXdCgXpTkHUk+nOR3s/mow08kuSvJX01yQ79To4AgFswag/jabHaTqB1DO1aMQxTruZDkx3L28/upJG/udI6cTRALZm1BfFPq/2K8nOSzsWPFaERxfs9O8p+y33P0D+OFZSMSxIJZUxBb7ljx8kbXxH78TXE+Nyb5lRz2HP2LeOvRaASxYNYSxJY7Vryk0TVxGFE83jExFMUxCWLBrCGILXes+IONronjiOLh5oihKI5HEAtmyUE8l+QfpU0M7VixPKK4vzljKIpjEcSCWWoQ7VhBCVEsVyOGojgOQSyYJQax9Y4VT2tzWVQiimerGUNRHIMgFszSgvj0JL+YNjG0Y8V6iOK1tYihKPYniAWzpCC23LHinfGDuzai+NVaxlAU+xLEgllKEO1YwRxE8Qk9YiiK/QhiwSwhiC9Ock/q/5A+ns1bOFg3UewbQ1HsQxALZvQg2rGCGk45iiPEUBTbE8SCGTmIr0hyf+r/UNqx4jSdYhRHiqEotiWIBTNqEF+V5KHU/2G0Y8VpO6UojhhDUWxHEAtmxCC+PvV/SV2OHSvYOIUojhxDUWxDEAtmtCDasYIe1hzFJcRQFOsTxIIZKYh2rKCnNUZxSTEUxboEsWBGCaIdKxjBmqK4xBiKYj2CWDC9g9hyx4pfix0rONsaorjkGO5GFOcliAXTM4jnk/zsNc5r7rFjBfu4mE20an5PXtoeZ25fm+S/Vz73y0kebnCMd8anRs1FEAumVxCfmuTOwnM8duxYwSGWuFJstTK8PckLk/xGg2NZKc5DEAumRxDtWMFSLCmKLWO4+5n6/RHFpRDEgmkdRDtWsDRLiGKPGO6I4jIIYsG0DKIdK1iqkaPYM4Y7ojg+QSyYVkG0YwVLN2IUR4jhjiiOTRALpkUQX5Y2O1Z8OXasoK6RojhSDHdEcVyCWDC1g/iKJJ+Z6Vyn5rEkf7HytUAyRhRHjOGOKI5JEAumZhBb7VjxSMbYTYDT0TOKI8dwRxTHI4gFUyuIrXaseCib8EJrPaK4hBjuiOJYBLFgagSx1Y4Vn8nmliz00jKKS4rhjiiOQxALZu4gvj12rOC0tPqYt49WPsblJO9Jcv28T09uSnJ3g3P3MW/TBLFg5gxiqx0r7snmbRwwihYrxdoz58rwSlaK/QliwcwRxJY7Vnwkmzf4w2iWHMWaMdwRxb4EsWCODeL1SW6b6VzOmg9l89FvMKolRrFFDHdEsR9BLJhjgthyx4pfzOZDwWF0S4piyxjuiGIfglgwhwax5Y4Vd2YTX1iKJUSxRwx3RLE9QSyYQ4LYcseK2zL/q96ghZGj2DOGO6LYliAWzL5BbLljxT+Ol1GzbCNGcYQY7ohiO4JYMPsEsdWOFZez2b4J1mCkKI4Uwx1RbEMQC6Y0iK12rHg8yVv2fTJgcCNEccQY7ohifYJYMCVBtGMFHK9nFEeO4Y4o1iWIBXNWEF8dO1bAXHpEcQkx3BHFegSxYKaC2HLHilcf82TAgrSM4pJiuCOKdQhiwVwriN+f5EszHWNqPp3kW459MmBhWnwg+OUkf6bVBc3MB4LPTxAL5mpBfEva7FjxyWxerAOnqMVK8dEs908RVorzEsSCuTKIdqyAdkRxmijORxALZhfE1jtWvGDm5wOWShSnieI8BLFgbknbHSs+HDtWwJVEcZooHk8QC+abY8cKGIEoThPF4whiwfzWTI9z1rwryYUqzwSsR4tXn17aHmeJvPr0cII4yPxU7FgBpawUp1kpHkYQBxg7VsD+RHGaKO5PEDuPHSvgcKI4TRT3I4idxo4VMA9RnCaK5QSxw9ixAuYlitNEsYwgNh47VkAdojhNFM8miA3ns0m+reoVw3i+NsnfT5sdJbwlY5q3ZEwTxEbzmSR/rO7lwnCeleRXsvkZuCNtomilOM1K8doEscHYsYJT9JUx3I0ojkEUr04QK48dKzhFV4uhKI5FFL+aIFYcO1ZwiqZiKIpjEcUnE8RKY8cKTlFJDEVxLKL4BEGsMB+MHSs4PfvEUBTHIoobgjjz3JnkqS0uDgZySAxFcSyiKIizjh0rOEU35vAYiuJYTj2KgjjT2LGCUzRHDEVxLKccRUGcYexYwSmaM4aiOJZTjaIgHjF2rOBU1YihKI7lFKMoiAeOHSs4VTVjKIpjObUoCuIBY8cKTlWLGF5OcnvaBDERxbOcUhQFcc95KMmrW14EDGKNMdwRxWmnEkVB3GPsWMGpWnMMd0Rx2ilEURALx44VnKpTiOGOKE5bexQFsWDsWMGpOp/kP+Y0YrgjitPWHEVBLJhvaX3iMIgfS/1ffO/JeJ/wdDHJpdS97kvb4yzRTUnuTv3vjXem7QeeCGLB3NL6xGEAL0r9KIwYwx1RnLbGKApiwQgip+gdqfuLbqTbpNfi9um0td0+FcSCEURO0YdT7xfcyCvDK1kpTlvTSlEQC0YQOUX3p84vttuznBjuWClOW8tKURALRhA5RTVWRUtaGV7JSnHaGlaKglgwgsgp+r+Z9xfZEleGV7JSnLb0laIgFowgcor+beb7BfbuLD+GO1aK05a8UhTEghFETtEPRAyvRRSnLTWKglgwgsgpuiHJvTnuZ2cNt0mvxe3TaUu8fSqIBSOInKo35/CfmzWuDK9kpThtaStFQSwYQeSU/Wj2/5n5uaw/hjuiOG1JURTEghFETt1bkzyWs39Wvpzkh9P28ydHIIrTlhJFQSwYQYTk5iQ/k+Tz+eqfkYeT3JHkG7udXX+iOG0JURTEghFEeMLXJPnWJN+X5M8n+fYkT+t6RuMQxWmjR1EQC0YQgVJefTpt5FefCmLBCCKwD1GcNmoUBbFgBBHYlyhOGzGKglgwgggcQhSnjRZFQSwYQQQO1SKKlyKKc0RREAtGEIFjiOK0UaIoiAUjiMCxRHHaCFEUxIIRRGAOojitdxQFsWAEEZiLKE7rGUVBLBhBBOYkitN6RVEQC0YQgbmJ4rQeURTEghFEoAZRnNY6ioJYMIII1CKK01pG8aUzPZYgAhzILhnTWu2S8QszPY4gAhzBSnFaq5WiIJ4xggi0IIrTlhJFQQSYgShOW0IUBRFgJqI4bfQoCiLAjERx2shRFESAmYnitFGjKIgAFYjitBGjKIgAlYjitNGiKIgAFYnitJGiKIgAlYnitFGiKIgADYjitBGiKIgAjYjitN5RFESAhkRxWs8oCiJAY6I4rVcUBRGgA1Gc1iOKggjQiShOax1FQQToSBSntYyiIAJ0JorTWkVREAEGIIrTWkRREAEGIYrTakdREAEGIorTakZREAEGI4rTakVREAEGJIrTakRREAEGJYrT5o6iIAIMTBSnzRlFQQQY3MVsolU7ihdbXdDM/mgGC+J1cz0QAE/y/mxWcJcqHuNCktuzzJXiF3qfwJUEEaCeu5K8IfWj+O4sM4pDEUSAukRxIQQRoD5RXABBBGhDFAcniADtiOLABBGgLVEclCACtCeKAxJEgD5EcTCCCNCPKA5EEAH6EsVBCCJAf6I4AEEEGIModnZ97xO4itckeVnvkwC4wpeTfCDJYxWPcVeSN2Xzgd0XKh1jF8W3J/lkpWOUuKnjsa/q3IyPdV+S58z4eACjeV+S703dKCab/RTvTPLUysdZg/uTPHeOB3LLFKDcG5O8K8n5ysdpcfuUKwgiwH5EcaUEEWB/orhCgghwGFFcGUEEOJworoggAhxHFFdCEAGOJ4orIIgA8xDFhRNEgPmI4oIJIsC8RHGhBBFgfqK4QIIIUIcoLowgAtQjigsiiAB1ieJCCCJAfaK4AIII0IYoDm7ODYLfm+SZMz4ewBrdkeSdDY5zMcntSS5UPs6nkvyvyseY8mCS7+54fAAW4NYkjyS5XHEeTfL6VhcEAIcSRQDYEkUA2BJFANgSRQDYEkUA2BJFANgSRQDYEkUA2BJFANgSRQDYEkUA2BJFANgSRQDYEkUA2BJFANgSRQDYEkUA2BJFANgSRQDYEkUA2BJFANgSRQDYEkUA2BJFANgSRQDYEkUA2BJFANgSRQDYupjkUupG8VKS17W6IAA4VIsofjHJy1tdEAAcqkUU/0eS61pdEAAcqkUU39jsagDgCLWjeEe7SwGA49SM4r0NrwMAjlYrio8nOd/wOgDgaLXep3h9y4sAgDnMvVL8ZNvTB4D5zBlFL6oBYNHmiqK3XQCweMdG0RvzAViNQ6Poo9sAWJ3XZRO4fWLow70BWKWXZ3ML9KwY/nqsDAFYueuyeZHMHdm8nWIXwXuTvG/77/zNEICTcz4CCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY/v/RctysOjKcJMAAAAASUVORK5CYII=";
                        ////newProduct.IsCurrentTicked = false;
                        DataProvider.Ins.DB.Products.Add(newProduct);
                        if (DataProvider.Ins.DB.SaveChanges() > 0)
                        {
                            MessageBox.Show("Thêm mới thành công!");
                            p.Close();
                        }
                        else MessageBox.Show("Thêm mới thất bại!");
                    }
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.ToString());
                }
            });
        }
        private void InitData()
        {
            sourceProduct = new List<Product>(DataProvider.Ins.DB.Products);
            MealTypeList = new ObservableCollection<MealType>(DataProvider.Ins.DB.MealTypes);
            ProductTypeList = new ObservableCollection<ProductType>(DataProvider.Ins.DB.ProductTypes);
            UnitList = new ObservableCollection<Unit>(DataProvider.Ins.DB.Units);
            StateList = new ObservableCollection<State>();
            State state1 = new State(true, "Đang kinh doanh", "Ngừng kinh doanh");
            State state2 = new State(false, "Đang kinh doanh", "Ngừng kinh doanh");
            StateList.Add(state1);
            StateList.Add(state2);
            initProduct = LocalDictionary.SmallProductMap[ProjectConstants.ProductSelectedItem]; LocalDictionary.SmallProductMap.Remove(ProjectConstants.ProductSelectedItem);
            IsClickedToImg = false;
        }

        public string BitmapImageToBase64(BitmapImage bmi)
        {
            byte[] data;
            JpegBitmapEncoder encoder = new JpegBitmapEncoder();
            encoder.Frames.Add(BitmapFrame.Create(bmi));
            using (MemoryStream ms = new MemoryStream())
            {
                encoder.Save(ms);
                data = ms.ToArray();
                string s = Convert.ToBase64String(data);
                return s;
            }
        }
        private bool CompareWithDeadPicture(ref string str)
        {
            if (str == "/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCAHEAcQDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD8qqKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/2Q==")
            {
                str = "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";
                return true;
            }
            return false;
        }
        
    }
}
